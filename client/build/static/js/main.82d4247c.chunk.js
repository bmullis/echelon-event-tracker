(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{37:function(e,t,n){e.exports=n(74)},73:function(e,t,n){},74:function(e,t,n){"use strict";n.r(t);var a=n(1),l=n.n(a),r=n(34),c=n.n(r),u=n(3),o=n(18),i=n(16),s=n.n(i),f=function(e){var t,n,a=e.marker;return l.a.createElement(o.a,{key:a.id,latitude:a.latitude,longitude:a.longitude},l.a.createElement("div",{style:{height:"18px",width:"18px",borderRadius:"500px",borderWidth:"3px",borderStyle:"solid",background:(n=a.type,"Crime"===n?"#cd4545":"Safety"===n?"#f16821":"Traffic"===n?"#f3a333":"#4f9da6"),borderColor:(t=a.severity,"Emergency"===t?"#CD4545":"High"===t?"#F16820":"Medium"===t?"#F3A333":"#237146")}}))},d=l.a.createContext([null,function(){}]),b=function(e){var t=Object(a.useState)(null),n=Object(u.a)(t,2),r=n[0],c=n[1];return Object(a.useEffect)(function(){c()},[]),l.a.createElement(d.Provider,{value:[r,c]},e.children)},m=function(e){var t=e.handleCloseAfterSubmit,n=Object(a.useState)(""),r=Object(u.a)(n,2),c=r[0],o=r[1],i=Object(a.useState)(""),s=Object(u.a)(i,2),f=s[0],b=s[1],m=Object(a.useState)(""),p=Object(u.a)(m,2),v=p[0],E=p[1],O=Object(a.useState)(""),j=Object(u.a)(O,2),h=j[0],g=j[1],y=Object(a.useContext)(d),S=Object(u.a)(y,2),w=(S[0],S[1]);return l.a.createElement("div",null,l.a.createElement("div",{className:"dropdown-form__header"},l.a.createElement("h4",null,"Report New Event")),l.a.createElement("div",{className:"dropdown-form__body"},l.a.createElement("form",{onSubmit:function(e){return function(e){e.preventDefault(),w({type:c,severity:f,title:v,description:h}),t()}(e)}},l.a.createElement("select",{required:!0,onChange:function(e){return o(e.target.value)},value:c},l.a.createElement("option",null,"Select event type..."),l.a.createElement("option",null,"Crime"),l.a.createElement("option",null,"Safety"),l.a.createElement("option",null,"Traffic")),l.a.createElement("select",{required:!0,onChange:function(e){return b(e.target.value)},value:f},l.a.createElement("option",null,"Select event severity..."),l.a.createElement("option",null,"Emergency"),l.a.createElement("option",null,"High"),l.a.createElement("option",null,"Medium"),l.a.createElement("option",null,"Low")),l.a.createElement("input",{required:!0,onChange:function(e){return E(e.target.value)},placeholder:"New event title...",value:v}),l.a.createElement("input",{required:!0,onChange:function(e){return g(e.target.value)},placeholder:"New event description...",value:h}),l.a.createElement("button",{type:"submit",className:"button"},"Select Location"))))},p=function(){var e=Object(a.useState)(!1),t=Object(u.a)(e,2),n=t[0],r=t[1],c=Object(a.useRef)(null);Object(a.useEffect)(function(){window.addEventListener("click",o)},[]);var o=function(e){e.target===c.current||c.current.contains(e.target)||r(!1)};return l.a.createElement("div",{style:{position:"relative"},ref:c},l.a.createElement("button",{className:"button button-round ".concat(n?"active":""),onClick:function(){return r(!n)}},"+"),n&&l.a.createElement("div",{className:"button-round__dropdown"},l.a.createElement(m,{handleCloseAfterSubmit:function(){r(!1)}})))},v=function(e){var t=Object(a.useState)(null),n=Object(u.a)(t,2),l=n[0],r=n[1];return Object(a.useEffect)(function(){s.a.get("/".concat(e)).then(function(e){r(e.data)}).catch(function(e){console.log(e)})},[e]),l},E=function(){var e=Object(a.useState)(null),t=Object(u.a)(e,2),n=t[0],l=t[1];return Object(a.useEffect)(function(){var e=localStorage.getItem("mapLocation"),t=JSON.parse(e);l(t)},[]),n},O=function(e,t){var n=[];return e.forEach(function(e){var a=(e.longitude-t._ne.lng)*(e.longitude-t._sw.lng)<0,l=(e.latitude-t._ne.lat)*(e.latitude-t._sw.lat)<0;a&&l&&n.push(e)}),n},j=l.a.createContext([null,function(){}]),h=function(e){var t=Object(a.useState)([]),n=Object(u.a)(t,2),r=n[0],c=n[1];return Object(a.useEffect)(function(){c()},[]),l.a.createElement(j.Provider,{value:[r,c]},e.children)},g=(n(63),function(){var e=Object(a.useState)(null),t=Object(u.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(null),i=Object(u.a)(c,2),b=i[0],m=i[1],h=Object(a.useState)(null),g=Object(u.a)(h,2),y=g[0],S=g[1],w=Object(a.useState)([]),C=Object(u.a)(w,2),x=C[0],k=C[1],N=Object(a.useContext)(j),R=Object(u.a)(N,2),L=(R[0],R[1]),_=Object(a.useContext)(d),J=Object(u.a)(_,2),M=J[0],T=J[1],q=Object(a.useState)(!1),z=Object(u.a)(q,2),A=z[0],F=z[1],W=Object(a.useState)({}),H=Object(u.a)(W,2),I=(H[0],H[1],Object(a.useRef)(null)),D=E(),X=I.current?I.current.getMap().getBounds():null;Object(a.useEffect)(function(){D?(r(D.latitude),m(D.longitude),S(D.zoom)):(r(33.42648270139036),m(-117.74208457016326),S(8.2))},[D]);var Y=v("events");Object(a.useEffect)(function(){Y&&k(Y)},[Y]),Object(a.useEffect)(function(){L(O(x,X))},[x]);return Object(a.useEffect)(function(){M&&F(!0)},[M]),l.a.createElement("div",null,b&&n&&y&&l.a.createElement("div",null,l.a.createElement(o.b,{getCursor:function(){return A?"crosshair":"pointer"},mapboxApiAccessToken:"pk.eyJ1IjoiYnJpYW5tdWxsaXMiLCJhIjoiY2o5OTk3cXk0MHFqMTJ3bXFobmR4b3h0byJ9.Fghhjfbn4qEHunu1wklljQ",height:"100vh",width:"75vw",latitude:n,longitude:b,mapStyle:"mapbox://styles/mapbox/dark-v9",ref:I,zoom:y,onViewportChange:function(e){var t=e.latitude,n=e.longitude,a=e.zoom;r(t),m(n),S(a),L(O(x,X)),localStorage.setItem("mapLocation",JSON.stringify({latitude:t,longitude:n,zoom:a}))},onClick:function(e){return function(e){A&&s.a.post("/events",{type:M.type,title:M.title,description:M.description,latitude:e.lngLat[1],longitude:e.lngLat[0],severity:M.severity}).then(function(e){k(x.concat(e.data)),T(null),F(!1)}).catch(function(e){console.log({err:e})})}(e)}},x.length>0&&x.map(function(e){return l.a.createElement(f,{key:e.id,marker:e})})),l.a.createElement(p,null)))}),y=n(17),S=function(){var e=Object(a.useState)(null),t=Object(u.a)(e,2),n=t[0],r=t[1],c=Object(a.useContext)(j),o=Object(u.a)(c,1)[0];return Object(a.useEffect)(function(){if(o){var e,t=[];o.sort(function(e,t){return e.type.localeCompare(t.type)}),o.forEach(function(n){if(n.type===e){var a=t.map(function(e){return e.label}).indexOf(n.type);t[a].angle++}else t.push({angle:1,label:n.type});e=n.type}),r(t)}},[o]),n&&l.a.createElement(y.a,{colorType:"category",colorRange:["#f3a333","#cd4545","#f16821"],data:n,height:350,width:350,innerRadius:70,radius:100,showLabels:!0,labelsStyle:{fill:"white",fontSize:18,fontWeight:500},stroke:"white",labelsRadiusMultiplier:1.6})},w=function(){var e=Object(a.useState)(null),t=Object(u.a)(e,2),n=t[0],r=t[1],c=Object(a.useContext)(j),o=Object(u.a)(c,1)[0];return Object(a.useEffect)(function(){if(o){var e,t=[];o.sort(function(e,t){return e.severity.localeCompare(t.severity)}),o.forEach(function(n){if(n.severity===e){var a=t.map(function(e){return e.label}).indexOf(n.severity);t[a].angle++}else t.push({angle:1,label:n.severity});e=n.severity}),r(t)}},[o]),n&&l.a.createElement(y.a,{colorType:"category",colorRange:["#f3a333","#cd4545","237145","#f16821"],data:n,height:350,width:350,innerRadius:70,radius:100,showLabels:!0,labelsStyle:{fill:"white",fontSize:18,fontWeight:500},stroke:"white",labelsRadiusMultiplier:1.6})},C=(n(73),function(){return l.a.createElement(h,null,l.a.createElement(b,null,l.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},l.a.createElement(g,null),l.a.createElement("div",{className:"graphs"},l.a.createElement("div",null,l.a.createElement("h3",null,"Events by Type"),l.a.createElement(S,null)),l.a.createElement("div",null,l.a.createElement("h3",null,"Events by Severity"),l.a.createElement(w,null))))))});c.a.render(l.a.createElement(C,null),document.querySelector("#root"))}},[[37,1,2]]]);
//# sourceMappingURL=main.82d4247c.chunk.js.map